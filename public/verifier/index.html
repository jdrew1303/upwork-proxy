<!DOCTYPE html>
<head>
  <title>Upwatcher verifier callback page</title>
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <h1>Success</h1>
  <img src="success.svg" id="success">
  <p>If you see this page more than <strong>5</strong> seconds press Close button</p>
  <button onclick="calToOpener()">Close</button>
  <script type="text/javascript">
    function calToOpener() {
      var locSearch = window.location.search.split('&'),
        verifier;
      locSearch.forEach(function(item) {
        if (item.indexOf('oauth_verifier') !== -1) {
          verifier = item.split('=')[1];
        }
      });
      if (window.opener) {
        window.opener.verifierWindowClose(verifier);
      } else {
        window.close();
      }
    }
    setTimeout(function() {
      calToOpener();
    }, 3000);
  </script>
</body>
